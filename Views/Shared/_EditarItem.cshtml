
@{
    ViewData["Title"] = "_EditarItem";
}

<div class="border border-2 rounded-2 p-2 mt-2">
    <form id="formEditarItem">
        <!--ID do Item-->
        <input type="hidden" name="Id" value="@Model.Id" />
        <!--ID do Orçamento-->
        <input type="hidden" name="OrcamentoId" value="@Model.OrcamentoId" />

        <div class="input-group mt-2">
            <span class="input-group-text">Descrição</span>
            <textarea class="form-control" name="Descricao" aria-label="With textarea" id="DescricaoItem">@Model.Descricao</textarea>
        </div>

        <hr>

        <div class="container mt-2 p-1">
            <div class="d-flex justify-content-between align-items-start">
                <div class="d-flex flex-column align-items-end mx-auto">
                    <div class="input-group mb-3" style="width: 200px;">
                        <span class="input-group-text" style="height: 30px;">R$</span>
                        <input type="text" step="0.01" name="ValorMaterial" class="form-control material" style="height: 30px;" id="ValorMaterial" value="@Model.ValorMaterial.ToString("N2")">
                    </div>
                    <div class="input-group mb-3" style="width: 200px;">
                        <span class="input-group-text" style="height: 30px;">R$</span>
                        <input type="text" step="0.01" name="ValorServico" class="form-control servicos" style="height: 30px;" id="ValorServico" value="@Model.ValorServico.ToString("N2")">
                    </div>
                </div>
            </div>
            <div class="d-flex justify-content-end">
                <button type="submit" class="btn btn-success atualizar">Atualizar</button>
                <button type="button" class="btn btn-danger ms-2" id="cancelar-edicao">Cancelar</button>
            </div>  
        </div>
    </form>
</div>
<script>
    $(document).on("click", "#cancelar-edicao", function () {
        $("#bloco-editar-item").hide().empty();
        $("#itemTemplate").show();
        $("#bloco-itens").show();
    });

    $(document).on("submit", "#formEditarItem", function (e) {
        e.preventDefault();

        $.ajax({
            url: '@Url.Action("Editar", "Item")',
            method: "POST",
            data: $(this).serialize(),
            success: function (html) {
                $("#bloco-itens").html(html).show();
                $("#bloco-editar-item").hide().empty();
                $("#itemTemplate").show();
            }
        })

        atualizarTotalMaterial(@Model.Id);
    })
</script>